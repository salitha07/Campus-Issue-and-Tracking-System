<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <title>Campus Issue Tracker</title>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <!-- Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@500;700;800;900&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link th:href="@{/css/landing.css}" rel="stylesheet">
</head>

<body>
<main class="landing">

    <!-- Parallax background -->
    <div class="bg-layer" aria-hidden="true"></div>
    <div class="bg-overlay" aria-hidden="true"></div>

    <!-- Top bar -->
    <header class="topbar">
        <span class="system-name">Campus Issue Tracker</span>

        <div class="top-actions" th:if="${#authorization.expression('isAnonymous()')}">
            <a class="btn btn-ghost" th:href="@{/login}">Login</a>
            <a class="btn btn-primary-solid" th:href="@{/signup}">Register</a>
        </div>

        <div class="top-actions" th:if="${#authorization.expression('isAuthenticated()')}">
            <a class="btn btn-primary-solid" th:href="@{/dashboard}">Dashboard</a>
        </div>
    </header>

    <!-- HERO (now includes the feature cards on first load) -->
    <section class="hero">
        <h1 class="hero-title animate delay-1">
            Keep the campus safe, clean, and working ‚Äî
            <span class="grad">report issues in seconds.</span>
        </h1>

        <!-- Typing paragraph (text will be typed by JS) -->
        <p class="hero-sub hero-sub-typing animate delay-2">
            <span id="typingText" aria-label="This platform helps NSBM students and staff report maintenance and safety issues fast, so the relevant team can respond quickly and update the status transparently."></span>
            <span class="typing-caret" aria-hidden="true"></span>
        </p>

        <!-- Feature cards visible on first page -->
        <div class="info-cards info-cards-hero">
            <div class="info-card">
                <div class="icon">‚ö°</div>
                <h4>Fast Reporting</h4>
                <p>Submit issues with clear location details and photos.</p>
            </div>

            <div class="info-card">
                <div class="icon">üïµÔ∏è</div>
                <h4>Anonymous Option</h4>
                <p>Report issues without revealing your identity.</p>
            </div>

            <div class="info-card">
                <div class="icon">üìä</div>
                <h4>Status Tracking</h4>
                <p>Track progress until the issue is resolved.</p>
            </div>
        </div>
    </section>

    <!-- SCROLL CONTENT (buttons live here, with more spacing) -->
    <section class="scroll-section">
        <div class="big-actions" th:if="${#authorization.expression('isAnonymous()')}">
            <a class="btn btn-primary-solid btn-xl" th:href="@{/login}">Login</a>
            <a class="btn btn-outline-light btn-xl" th:href="@{/signup}">Register</a>
        </div>

        <div class="big-actions" th:if="${#authorization.expression('isAuthenticated()')}">
            <a class="btn btn-primary-solid btn-xl" th:href="@{/dashboard}">Go to Dashboard</a>
        </div>
    </section>

</main>

<!-- Parallax script -->
<script>
    (function () {
      const bg = document.querySelector(".bg-layer");
      if (!bg) return;

      let latestY = 0;
      let ticking = false;

      function update() {
        ticking = false;
        const offset = latestY * 0.18;
        bg.style.transform = `translate3d(0, ${offset}px, 0) scale(1.06)`;
      }

      function onScroll() {
        latestY = window.scrollY || 0;
        if (!ticking) {
          ticking = true;
          requestAnimationFrame(update);
        }
      }

      onScroll();
      window.addEventListener("scroll", onScroll, { passive: true });
    })();
</script>

<!-- Typing effect (continuous loop) -->
<script>
    (function () {
      const el = document.getElementById("typingText");
      if (!el) return;

      const fullText = el.getAttribute("aria-label") || "";
      const typeSpeed = 28;      // typing speed (ms)
      const pauseAfter = 1100;   // pause after full sentence
      const deleteSpeed = 16;    // deleting speed (ms)
      const pauseBefore = 400;   // pause before start typing again

      let i = 0;
      let deleting = false;

      function tick() {
        if (!deleting) {
          i++;
          el.textContent = fullText.slice(0, i);

          if (i >= fullText.length) {
            setTimeout(() => { deleting = true; tick(); }, pauseAfter);
            return;
          }
          setTimeout(tick, typeSpeed);
        } else {
          i--;
          el.textContent = fullText.slice(0, i);

          if (i <= 0) {
            deleting = false;
            setTimeout(tick, pauseBefore);
            return;
          }
          setTimeout(tick, deleteSpeed);
        }
      }

      tick();
    })();
</script>

</body>
</html>
